# Nightscout Extended Dashboard –¥–ª—è Home Assistant
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ —Ä–∞–∑–¥–µ–ª Dashboard (Lovelace UI) –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –ø–∞–Ω–µ–ª—å
# –î–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —á–µ—Ä–µ–∑ HACS:
# - mini-graph-card
# - layout-card (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –ª—É—á—à–µ–≥–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è)

type: vertical-stack
cards:
  # ============ –û–°–ù–û–í–ù–û–ô –ò–ù–î–ò–ö–ê–¢–û–† –ì–õ–Æ–ö–û–ó–´ ============
  - type: horizontal-stack
    cards:
      # –ë–æ–ª—å—à–æ–π gauge –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
      - type: gauge
        entity: sensor.blood_sugar
        name: –ì–ª—é–∫–æ–∑–∞ –∫—Ä–æ–≤–∏
        min: 40
        max: 400
        severity:
          green: 70
          yellow: 180
          red: 250
        needle: true
        unit: mg/dL
        segments:
          - from: 40
            color: '#e74c3c'
          - from: 70
            color: '#2ecc71'
          - from: 180
            color: '#f39c12'
          - from: 250
            color: '#e74c3c'
      
      # –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
      - type: entities
        entities:
          - entity: sensor.nightscout_loop_status
            name: –°—Ç–∞—Ç—É—Å –ø–µ—Ç–ª–∏
            icon: mdi:sync
          - entity: sensor.nightscout_device_status
            name: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
            icon: mdi:devices
          - entity: sensor.blood_sugar
            type: attribute
            attribute: direction
            name: –¢—Ä–µ–Ω–¥
          - entity: sensor.blood_sugar
            type: attribute
            attribute: delta
            name: –ò–∑–º–µ–Ω–µ–Ω–∏–µ

  # ============ –û–°–ù–û–í–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–û–ù–ù–ê–Ø –ü–ê–ù–ï–õ–¨ ============
  - type: entities
    title: üìä –¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
    show_header_toggle: false
    state_color: true
    entities:
      - entity: sensor.blood_sugar
        name: ü©∏ –ì–ª—é–∫–æ–∑–∞
        icon: mdi:water
      - type: divider
      - type: section
        label: –ê–∫—Ç–∏–≤–Ω—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞
      - entity: sensor.nightscout_insulin_on_board
        name: üíâ –ê–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Å—É–ª–∏–Ω (IOB)
        icon: mdi:needle
      - entity: sensor.nightscout_carbs_on_board
        name: üçé –ê–∫—Ç–∏–≤–Ω—ã–µ —É–≥–ª–µ–≤–æ–¥—ã (COB)
        icon: mdi:food-apple
      - entity: sensor.nightscout_sensitivity_ratio
        name: üìà –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
        icon: mdi:chart-line-variant
      - type: divider
      - type: section
        label: –ü–æ–º–ø–∞ –∏ –±–∞–∑–∞–ª
      - entity: sensor.nightscout_basal_rate
        name: üíß –ë–∞–∑–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
        icon: mdi:water-pump
      - entity: sensor.nightscout_temp_basal
        name: ‚è±Ô∏è –í—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–∑–∞–ª
        icon: mdi:water-pump-off
      - entity: sensor.nightscout_pump_reservoir
        name: üß™ –†–µ–∑–µ—Ä–≤—É–∞—Ä –ø–æ–º–ø—ã
        icon: mdi:water-outline

  # ============ –†–ê–°–ß–ï–¢–ù–´–ô HbA1c ============
  - type: entities
    title: üìâ –†–∞—Å—á–µ—Ç–Ω—ã–π –≥–ª–∏–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥–µ–º–æ–≥–ª–æ–±–∏–Ω (eA1c)
    show_header_toggle: false
    state_color: false
    entities:
      - entity: sensor.nightscout_ea1c_24h
        name: eA1c –∑–∞ 24 —á–∞—Å–∞
        icon: mdi:clock-outline
        secondary_info: last-changed
      - entity: sensor.nightscout_ea1c_7d
        name: eA1c –∑–∞ 7 –¥–Ω–µ–π
        icon: mdi:calendar-week
        secondary_info: last-changed
      - entity: sensor.nightscout_ea1c_30d
        name: eA1c –∑–∞ 30 –¥–Ω–µ–π
        icon: mdi:calendar-month
        secondary_info: last-changed
      - entity: sensor.nightscout_ea1c_90d
        name: eA1c –∑–∞ 90 –¥–Ω–µ–π
        icon: mdi:calendar-range
        secondary_info: last-changed

  # ============ –ì–†–ê–§–ò–ö –ì–õ–Æ–ö–û–ó–´ ============
  - type: history-graph
    title: üìà –ò—Å—Ç–æ—Ä–∏—è –≥–ª—é–∫–æ–∑—ã (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 8 —á–∞—Å–æ–≤)
    hours_to_show: 8
    refresh_interval: 60
    entities:
      - entity: sensor.blood_sugar
        name: –ì–ª—é–∫–æ–∑–∞

  # ============ –†–ê–°–®–ò–†–ï–ù–ù–´–ï –ì–†–ê–§–ò–ö–ò ============
  - type: horizontal-stack
    cards:
      # –ì—Ä–∞—Ñ–∏–∫ IOB
      - type: custom:mini-graph-card
        name: –ê–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Å—É–ª–∏–Ω (IOB)
        icon: mdi:needle
        entities:
          - entity: sensor.nightscout_insulin_on_board
            name: IOB
            color: '#3498db'
        hours_to_show: 8
        points_per_hour: 12
        line_width: 3
        animate: true
        show:
          graph: line
          fill: fade
          points: false
          legend: false
      
      # –ì—Ä–∞—Ñ–∏–∫ COB
      - type: custom:mini-graph-card
        name: –ê–∫—Ç–∏–≤–Ω—ã–µ —É–≥–ª–µ–≤–æ–¥—ã (COB)
        icon: mdi:food-apple
        entities:
          - entity: sensor.nightscout_carbs_on_board
            name: COB
            color: '#e67e22'
        hours_to_show: 8
        points_per_hour: 12
        line_width: 3
        animate: true
        show:
          graph: line
          fill: fade
          points: false
          legend: false

  # ============ –¢–†–ï–ù–î eA1c ============
  - type: custom:mini-graph-card
    name: üìä –î–∏–Ω–∞–º–∏–∫–∞ eA1c –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º
    icon: mdi:chart-line
    height: 150
    hours_to_show: 168
    group: true
    entities:
      - entity: sensor.nightscout_ea1c_24h
        name: 24—á
        color: '#e74c3c'
      - entity: sensor.nightscout_ea1c_7d
        name: 7–¥
        color: '#f39c12'
      - entity: sensor.nightscout_ea1c_30d
        name: 30–¥
        color: '#2ecc71'
      - entity: sensor.nightscout_ea1c_90d
        name: 90–¥
        color: '#3498db'
    show:
      graph: line
      fill: false
      points: true
      legend: true
      labels: true

  # ============ –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ò –ë–ê–¢–ê–†–ï–ò ============
  - type: horizontal-stack
    cards:
      # –ë–∞—Ç–∞—Ä–µ—è –ø–æ–º–ø—ã
      - type: entity
        entity: sensor.nightscout_pump_battery
        name: –ë–∞—Ç–∞—Ä–µ—è –ø–æ–º–ø—ã
        icon: mdi:battery
        state_color: true
      
      # –ë–∞—Ç–∞—Ä–µ—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
      - type: entity
        entity: sensor.nightscout_phone_battery
        name: –ë–∞—Ç–∞—Ä–µ—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
        icon: mdi:cellphone-charging
        state_color: true
      
      # –†–µ–∑–µ—Ä–≤—É–∞—Ä
      - type: entity
        entity: sensor.nightscout_pump_reservoir
        name: –†–µ–∑–µ—Ä–≤—É–∞—Ä
        icon: mdi:water-outline

  # ============ –ü–û–°–õ–ï–î–ù–ò–ï –î–ï–ô–°–¢–í–ò–Ø ============
  - type: entities
    title: üìù –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π
    show_header_toggle: false
    entities:
      - entity: sensor.nightscout_last_treatment
        name: –ü–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ
        icon: mdi:clipboard-text-clock
      - entity: sensor.nightscout_last_bolus
        name: –ü–æ—Å–ª–µ–¥–Ω–∏–π –±–æ–ª—é—Å
        icon: mdi:needle
      - entity: sensor.nightscout_last_carbs
        name: –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É–≥–ª–µ–≤–æ–¥—ã
        icon: mdi:food

  # ============ –°–¢–ê–¢–ò–°–¢–ò–ö–ê Time in Range ============
  - type: custom:mini-graph-card
    name: üéØ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ (–∑–∞ 24—á)
    icon: mdi:chart-donut
    hours_to_show: 24
    points_per_hour: 12
    entities:
      - entity: sensor.blood_sugar
        name: –ì–ª—é–∫–æ–∑–∞
        color: '#2ecc71'
    show:
      graph: line
      fill: fade
      points: false
      state: true
      legend: true
    color_thresholds:
      - value: 70
        color: '#e74c3c'
      - value: 70
        color: '#2ecc71'
      - value: 180
        color: '#f39c12'
      - value: 250
        color: '#e74c3c'

  # ============ –ö–û–ú–ü–ê–ö–¢–ù–ê–Ø –ö–ê–†–¢–û–ß–ö–ê –û–ë–ó–û–†–ê ============
  - type: glance
    title: üîç –ë—ã—Å—Ç—Ä—ã–π –æ–±–∑–æ—Ä
    columns: 4
    show_state: true
    entities:
      - entity: sensor.blood_sugar
        name: –ì–ª—é–∫–æ–∑–∞
      - entity: sensor.nightscout_insulin_on_board
        name: IOB
      - entity: sensor.nightscout_carbs_on_board
        name: COB
      - entity: sensor.nightscout_ea1c_7d
        name: eA1c 7–¥
      - entity: sensor.nightscout_pump_reservoir
        name: –†–µ–∑–µ—Ä–≤—É–∞—Ä
      - entity: sensor.nightscout_pump_battery
        name: –ü–æ–º–ø–∞
      - entity: sensor.nightscout_phone_battery
        name: –¢–µ–ª–µ—Ñ–æ–Ω
      - entity: sensor.nightscout_sensitivity_ratio
        name: –ß—É–≤—Å—Ç–≤-—Ç—å
      - entity: sensor.nightscout_ea1c_90d
        name: 90–¥
        color: '#3498db'
    hours_to_show: 168
    points_per_hour: 0.25
    line_width: 2
    animate: true
    show:
      labels: true
      points: false

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞
---
type: glance
title: Nightscout –ö—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä
show_name: true
show_icon: true
show_state: true
entities:
  - entity: sensor.blood_sugar
    name: BG
  - entity: sensor.nightscout_insulin_on_board
    name: IOB
  - entity: sensor.nightscout_carbs_on_board
    name: COB
  - entity: sensor.nightscout_pump_reservoir
    name: –†–µ–∑–µ—Ä–≤—É–∞—Ä
  - entity: sensor.nightscout_pump_battery
    name: –ü–æ–º–ø–∞
  - entity: sensor.nightscout_phone_battery
    name: –¢–µ–ª–µ—Ñ–æ–Ω
